from docxtpl import DocxTemplate
import json

a = {'wind_data': {}, 'name': '\xe5\x88\x98\xe6\xb1\x9f\xe9\xbb\x84\xe6\xb2\xb3\xe5\xa4\xa7\xe6\xa1\xa51\xe8\xb7\xa8', 'humidity_data': {}, 'naodu_data': None, 'mdetail_data': {}, 'vibrate_data': None, 'start': '2017\xe5\xb9\xb411\xe6\x9c\x8806\xe6\x97\xa5', 'error_nodes': 0, 'temp_data': {}, 'run_status': {'HOS_4000': {'error_num': 0, 'id_num': 6}, 'IncliHCF200': {'error_num': 0, 'id_num': 10}, 'NAODU': {'error_num': 0, 'id_num': 2}, 'CablePeaksHCF100': {'error_num': 0, 'id_num': 8}, 'VibraHCF300': {'error_num': 0, 'id_num': 6}}, 'now': '2017\xe5\xb9\xb411\xe6\x9c\x8806\xe6\x97\xa5', 'monitor_data': {'HOS_4000': {'unit_name': '\xe5\xba\x94\xe5\x8f\x98(\xce\xbc\xce\xb5)', 'inc_val': None, 'sensor_id': '\xe6\x97\xa0', 'name': '\xe5\xba\x94\xe5\x8f\x98(HFS100/HFS200/HFS400/HFS316/HFS500/HFS500 HFS616+HOS_4000)', 'detail_val': {1: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 2: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 3: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 4: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 5: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 6: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}}}, 'IncliHCF200': {'unit_name': '\xe7\xa9\xba\xe9\x97\xb4\xe8\xa7\x92(\xc2\xb0)', 'inc_val': None, 'sensor_id': '\xe6\x97\xa0', 'name': '\xe5\x80\xbe\xe8\xa7\x92(HCF200,HCF400,HCF410,HCF400-L)', 'detail_val': {1: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 2: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 3: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 4: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 5: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 6: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 7: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 8: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 9: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 10: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}}}, 'NAODU': {'unit_name': '\xe6\x8c\xa0\xe5\xba\xa6\xe5\x80\xbc(\xe7\xb1\xb3)', 'inc_val': None, 'sensor_id': '\xe6\x97\xa0', 'name': '\xe6\x8c\xa0\xe5\xba\xa6(HCF2000,HCF200,HCF400,HCF410)', 'detail_val': {1: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 2: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}}}, 'CablePeaksHCF100': {'unit_name': '\xe7\xb4\xa2\xe5\x8a\x9b(KN)', 'inc_val': None, 'sensor_id': '\xe6\x97\xa0', 'name': '\xe7\xb4\xa2\xe5\x8a\x9b(HCF100,HCF400,HCF400-L0)', 'detail_val': {1: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 2: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 3: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 4: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 5: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 6: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 7: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 8: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}}}, 'VibraHCF300': {'unit_name': '\xe6\x8c\xaf\xe5\x8a\xa8(m/s\xc2\xb2)', 'inc_val': None, 'sensor_id': '\xe6\x97\xa0', 'name': '\xe6\x8c\xaf\xe5\x8a\xa8(HCF300,HCF400,HCF410)', 'detail_val': {1: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 2: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 3: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 4: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 5: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}, 6: {'speed': '', 'val': '\xe6\x97\xa0\xe6\x95\xb0\xe6\x8d\xae', 'mean': None}}}}}
a= json.loads(json.dumps(a).encode('gbk'))
template = '/home/suyf/swork/git/sensorcmd-web/web/static/doc_templet/dailyreport.docx'
tpl=DocxTemplate(template)
tpl.render(a)